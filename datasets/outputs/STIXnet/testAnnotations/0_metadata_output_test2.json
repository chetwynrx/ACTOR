{
  "documents": [
    {
      "document_id": "user_0",
      "title": "0",
      "pages": [
        {
          "page_number": 0,
          "topics": [
            "Threat Actor",
            "Software",
            "Technique",
            "Domain",
            "Email",
            "Filename",
            "Directory",
            "Malware",
            "IPV4",
            "IPV6",
            "Process"
          ],
          "text": "Executive SummaryIn this report, we unveil a sophisticated cyberattack orchestrated by APT29, anadvanced persistent threat group linked to Russia's Foreign Intelligence Service (SVR).The targets of this attack spanned multiple European nations, including Azerbaijan,Greece, Romania, and Italy, with the primary goal of infiltrating embassy entities.APT29 leveraged a newly discovered vulnerability in WinRAR, identified asCVE-2023-38831, to facilitate their intrusion.This report delves into the intricate details of these cyber operations, shedding light onthe attackers' tactics, techniques, and procedures. APT29 ingeniously employedbenign-looking lures in the form of enticing BMW car sale photos and documents,expertly crafted to draw in unsuspecting victims. The lure documents containedhidden, malicious content that exploited the WinRAR vulnerability, granting attackersaccess to the compromised systems.This campaign exemplifies the evolving nature of cyber threats and the persistentendeavors of nation-state-sponsored actors to compromise critical entities. The insightswithin this report aim to raise awareness about the complex threat landscape faced bydiplomatic missions and organizations, ultimately fostering a proactive approach tocybersecurity defense.Geopolitical ImplicationsAt the outset of September 2023, the infamous APT29, affiliated with Russia's SVR,embarked on a sweeping cyber offensive that cast a wide net, targeting embassies,international organizations, and even internet service providers. Their primary focusrested on diplomatic accounts, with the Ministry of Foreign Affairs (MFA) inAzerbaijan and Italy bearing the brunt of the onslaught. Additionally, embassiessituated in Greece and Romania, along with the email accounts of a prominent GreekISP, Otenet, were also among the numerous targets. The list of victims extended toencompass major international organizations, emphasizing the audacity and scope ofthis campaign.Figure.1 Map of countries with the most targeted accounts.Table.1 List of international organizations targeted in APT29 campaign.The geopolitical implications are profound. Among the several conceivable motives,one of the most apparent aims of the SVR might be to gather intelligence concerningAzerbaijan's strategic activities, especially in the lead-up to the Azerbaijani invasion ofNagorno-Karabakh. It's noteworthy that the countries targeted—Azerbaijan, Greece,Romania, and Italy—maintain significant political and economic ties with Azerbaijan.In a noteworthy development, Azerbaijan had recently struck an agreement to procuremilitary aircraft from Italy, marking a rare arms deal with a Western nation.The attack methodology entailed the use of phishing emails equipped with enticinglures, portraying BMW car sales, which is a tactic previously employed by APT29 inattacks on embassies in Kyiv. This campaign, consisting of over 200 targeted emailaddresses, accentuates the evolving nature of cyber threats in the international arena.Figure.2 APT29 phishing email with BMW car for sale theme.Domain Organization@gccsg.org Secretariat General of the Gulf Cooperation Council@ec.europa.eu European Commission@unhcr.org United Nations High Commissioner for Refugees@unicef.org United Nations International Children's Emergency Fund@auf.org Agence universitaire de la Francophonie@francophonie.org Organisation Internationale de la Francophonie (OIF)@iom.int International Organization for Migration@worldbank.org The World Bank@selec.org Southeast European Law Enforcement Center@coe.int Council of Europe@euro.who.int World Health Organization European RegionOld And New TacticsAPT29's persistence in using the BMW car for sale theme as a lure in their phishingattacks has taken on a new dimension with the deployment of a thematically namedRAR archive, 'DIPLOMATIC-CAR-FOR-SALE-BMW.rar.' This archive contains arecently disclosed and exploitable vulnerability, CVE-2023-38831. This vulnerability,which came to light in April 2023, is rooted in the mishandling of ZIP archives thatseemingly contain innocuous files, like standard .PDF documents, and folders sharingidentical names.The core issue lies in the archives, where threat actors can surreptitiously insert folderswith matching names. When an unsuspecting user attempts to access one of the benignfiles, the ZIP archive may contain a similarly named folder concealing executablecontent, often hosting malware or other malicious code. In the course of the user'seffort to open the harmless file, the system unwittingly processes the concealedmalicious content within the folder with a matching name, thus enabling the executionof arbitrary code.In the context of this particular attack, a script is executed, generating a PDF filefeaturing the lure theme of a BMW car for sale. Simultaneously, in the background, aPowerShell script is downloaded and executed from the next-stage payload server.Notably, the attackers introduced a novel technique for communicating with themalicious server, employing a Ngrok free static domain to access their server hosted ontheir Ngrok instance.Figure.3 “DIPLOMATIC-CAR-FOR-SALE-BMW.pdf” lure document.Figure.4 PowerShell script deploying .pdf lure and downloading next-stage payload from ngrok-free.app.Ngrok, at its core, is an incredibly versatile and cross-platform tool designed to exposelocal network ports securely to the internet through a process known as tunneling.However, in the context of cyber adversaries, Ngrok has taken on a different role.Instead of legitimate purposes, adversaries have begun leveraging Ngrok to store theirnext-stage PowerShell payloads and establish covert communication channels.In this nefarious tactic, they utilize Ngrok's services by utilizing free static domainsprovided by Ngrok, typically in the form of a subdomain under 'ngrok-free.app.'These subdomains act as discrete and inconspicuous rendezvous points for theirmalicious payloads. This clever adaptation allows the adversaries to obfuscate theiractivities and communicate with compromised systems while evading detection. Byexploiting Ngrok's capabilities in this manner, threat actors can further complicatecybersecurity efforts and remain under the radar, making defense and attribution morechallenging.CVE-2023-38831A critical security flaw, identified as CVE-2023-38831, has been discovered in earlierversions of RARLab's WinRAR software, specifically those released prior to version6.23. This vulnerability poses a significant threat as it allows attackers to executearbitrary code through the exploitation of a specially crafted ZIP archive.The root cause of this vulnerability lies in the incorrect handling of ZIP archives thatcontain seemingly benign files, such as standard .PDF documents, alongside foldersbearing identical names. The crux of the issue is that within these archives, maliciousactors can insert folders with matching names. When a user attempts to access one ofthe harmless files, the ZIP archive may include a folder with the same name thatcontains executable content, often malware or other malicious code. During the user'sattempt to open the benign file, the system unwittingly processes the malicious contentwithin the similarly named folder, resulting in the execution of arbitrary code.Figure.5 WinRAR archive exploiting CVE-2023-38831.This vulnerability has not remained merely theoretical; it has been activelyexploited in real-world incidents. These attacks have been observed occurringbetween April and October of 2023. Attackers utilize this vulnerability to craftmalicious ZIP archives and distribute them via various channels, such as emailattachments or compromised websites. Unsuspecting users who open theseseemingly benign files can unknowingly trigger the execution of malicious code,granting attackers access to the victim's system, and potentially leading to a hostof detrimental consequences, including data theft, system compromise, andmore. The PoC of this vulnerability is publicly available.In August 2023, ESET researchers discovered another spearphishing campaignattributed to Sednit APT exploiting the CVE-2023-38831 vulnerability inWinRAR. Sednit, also known as APT28, a threat actor group closely associatedwith the Russian military intelligence agency, GRU. Sednit's approach was toemploy emails with lures that revolved around the agenda of the EuropeanParliament. This was a calculated choice, as the campaign's primary targets werepolitical entities within the European Union and Ukraine.A concerning trend of exploiting CVE-2023-38831 vulnerability by Russianintelligence services hacking groups demonstrates its growing popularity andsophistication. It becomes increasingly essential for organizations and securityprofessionals to remain vigilant and proactive in defending against these threats.It is of utmost important for WinRAR users to update their software to version6.23 or later, which includes the necessary security patches to mitigate thiscritical vulnerability. Furthermore, practicing caution when opening filesreceived from unknown sources or untrusted locations is an additional layer ofdefense against potential exploitation of this vulnerability. Cybersecurityawareness and prompt software updates are crucial in maintaining a resilientdefense against such threats.ConclusionIn this comprehensive report, we've delved into the intricate campaignorchestrated by APT29, a threat group associated with Russia's intelligenceapparatus. Their targeted attack against embassies, particularly in Azerbaijan,Greece, Romania, and Italy, offers a sobering view of the evolving threatlandscape.One of the most apparent geopolitical motives behind these attacks is the questfor intelligence, especially concerning Azerbaijan's impending actions inNagorno-Karabakh. It's a stark reminder that cyber-espionage is a tool ofstatecraft, and its reach extends to diverse regions and sectors.What makes this campaign particularly noteworthy is the synthesis of old andnew techniques. APT29 continues to employ the BMW car for sale lure theme, atactic that's been seen in the past. However, the deployment of theCVE-2023-38831 WinRAR vulnerability, a novel approach, reveals theiradaptability to the evolving threat landscape. Additionally, their use of Ngrokservices to establish covert communications emphasizes their determination toremain concealed.Furthermore, the prevalence of similar techniques among Russian hackinggroups underscores the imperative for organizations to take robust securitymeasures seriously. Implementing stringent cybersecurity practices, stayingupdated on the latest vulnerabilities, and fostering a culture of cybersecurityawareness are vital to guarding against these complex and persistent threats.Indicators of CompromiseType Valuefilename NEAS.f78ee3005ca9f0e78a9dd136fc69afe7c06d69d1fc6218bc9e7eb3adec045977zip.zipmd5 3b641b7e68b671da6497d10f773dcf7csha-1 37c619b18ba52956c249551587b955e7b2066b73sha-256 f78ee3005ca9f0e78a9dd136fc69afe7c06d69d1fc6218bc9e7eb3adec045977filename payload_1.ps1md5 2b9812a7793c3fe0f171456acd9edf02sha-1 448047b975175cb9c1e8b36036324835a9e9943esha-256 5d6bfb8fd1102273ef489060219293f8da796d07e8b2872efbda55050512b71ffilename Car for sale.emlmd5 ff7d1fb202bac38345be8cf267fa6688sha-1 3da35178fb0b3a8ef51b78a07c719658a628d722sha-256 eec902a61886198a8e48ac862fabeecd628f2fa4122b78a0d7d6ee5c256ae724url http://d287-206-123-149-139.ngrok-free.app/b125.ps1domain d287-206-123-149-139.ngrok-free.appemail address a.menmedov@outlook.com"
        }
      ]
    }
  ]
}